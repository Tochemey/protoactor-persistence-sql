os: linux
dist: xenial

env:
  global:
    - DOCKERHUB_USERNAME=$DOCKERHUB_USERNAME
    - DOCKERHUB_TOKEN=$DOCKERHUB_TOKEN

before_install:
  - docker login --username "$DOCKERHUB_USERNAME" --password "$DOCKERHUB_TOKEN"

install:
  - sudo /bin/sh -c 'wget https://github.com/earthly/earthly/releases/download/v0.5.8/earthly-linux-amd64 -O /usr/local/bin/earthly && chmod +x /usr/local/bin/earthly'

stages:
  - test

jobs:
  include:
    - stage: test
      script:
        - earthly --version
        - earthly -P --build-arg COMMIT_HASH=$TRAVIS_COMMIT --build-arg BRANCH_NAME=$TRAVIS_BRANCH --build-arg CODECOV_TOKEN=$CODECOV_TOKEN --build-arg BUILD_NUMBER=$TRAVIS_BUILD_NUMBER  +all
